<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Paginatto ‚Äî √Årea de Membros</title>

  <style>
    :root{
      --bg: #0d5f70;
      --bg-soft: #0e6f83;
      --page: #f6fbfc;
      --card: #ffffff;
      --ink: #0f2024;
      --muted:#6a7a80;
      --brand:#12a4bd;
      --brand-2:#0db2c9;
      --gold:#c8a96a;
      --shadow: 0 8px 24px rgba(3,41,48,.10);
      --radius: 16px;
    }
    *{ box-sizing:border-box; margin:0; padding:0; }
    body{
      background: var(--page);
      color: var(--ink);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Inter, Arial, sans-serif;
      line-height: 1.55;
    }

    /* ====== TELA 1 (LANDING) ====== */
    #landing{
      min-height: 100vh;
      position: relative;
      color:#ffffff;
      background-image: url('logo azul sem sombra.png');
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
    }
    #landing::before{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(
        180deg,
        rgba(0,0,0,0.55) 0%,
        rgba(0,0,0,0.65) 40%,
        rgba(0,0,0,0.75) 100%
      );
      z-index:0;
    }
    .landing-inner{
      position:relative;
      z-index:1;
      min-height:100vh;
      max-width:1100px;
      margin:0 auto;
      padding:20px 18px 40px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:space-between;
    }
    .landing-header{
      width:100%;
      display:flex;
      justify-content:center;
      margin-top:6px;
    }
    .landing-brand{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
    }
    .landing-brand-name{
      font-weight:700;
      letter-spacing:.22em;
      font-size:15px;
      text-transform:uppercase;
      opacity:.9;
    }
    .hero{
      width:100%;
      max-width:540px;
      margin:0 auto;
      text-align:center;
      display:grid;
      gap:18px;
      padding-bottom:60px;
    }
    .hero h1{
      font-size: clamp(28px, 5vw, 40px);
      line-height:1.15;
      font-weight:800;
      text-shadow:0 10px 30px rgba(0,0,0,.7);
    }
    .hero p{
      opacity:.95;
      max-width:420px;
      margin:0 auto;
      font-size:14px;
    }
    .btn-primary{
      appearance:none;
      border:0;
      border-radius: 999px;
      padding: 14px 22px;
      background: linear-gradient(90deg, #18b0c8 0%, #22d1e2 100%);
      color:#00333d;
      font-weight: 800;
      letter-spacing:.12em;
      text-transform:uppercase;
      box-shadow: 0 14px 34px rgba(0,0,0,.55);
      cursor:pointer;
      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
    }
    .btn-primary:hover{
      transform:translateY(-1px);
      box-shadow:0 18px 40px rgba(0,0,0,.65);
      filter:brightness(1.02);
    }
    .btn-primary:active{
      transform:translateY(1px);
      box-shadow:0 10px 22px rgba(0,0,0,.55);
      filter:brightness(.98);
    }

    /* ====== HEADER / NAV APP ====== */
    #appHeader{
      position: sticky;
      top: 0;
      z-index: 50;
      background: linear-gradient(180deg, rgb(215, 217, 218) 0%, rgba(13,95,112,.92) 50%);
      color:#141313;
      box-shadow: var(--shadow);
    }
    .nav-wrap{
      max-width: 980px; margin: 0 auto;
      padding: 10px 14px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      position: relative;
    }
    .brand-mini{ display:flex; align-items:center; gap:10px; cursor:pointer }
    .brand-mini img{ width:30px; height:30px; object-fit:contain }
    .brand-mini span{ font-weight:800; letter-spacing:.4px }

    .menu{
      display:flex; align-items:center; gap:14px;
      overflow-x:auto; scrollbar-width:none;
    }
    .menu a, .menu button{
      color:#e8fdff; text-decoration:none; white-space:nowrap;
      font-size:14px; font-weight:700; letter-spacing:.2px;
      background:transparent; border:0; cursor:pointer; padding:8px 10px;
      border-radius: 10px;
    }
    .menu a:hover, .menu button:hover{ background: rgba(255,255,255,.08) }

    .menu-toggle{
      display:none;
      align-items:center;
      justify-content:center;
      width:32px;
      height:32px;
      border-radius:999px;
      border:0;
      background:rgba(255,255,255,0.12);
      color:#e8fdff;
      cursor:pointer;
      font-size:18px;
    }

    /* ====== BUSCA ====== */
    .search-bar{
      max-width:980px; margin: 14px auto 0; padding: 0 14px 12px;
    }
    .search{
      display:flex; gap:8px; background:var(--card); border-radius:999px; padding:8px 8px 8px 14px;
      box-shadow: var(--shadow);
    }
    .search input{
      border:0; outline:0; flex:1; font-size:14px; background:transparent; color:var(--ink);
    }
    .icon-btn{
      width:38px; height:38px; border-radius:50%; border:0; cursor:pointer;
      background:linear-gradient(120deg, var(--brand) 0%, var(--brand-2) 100%);
      color:#00313a; font-weight:800;
    }

    /* ====== CONTE√öDO ====== */
    .section{
      max-width: 980px; margin: 12px auto 24px; padding: 0 14px;
    }
    .h2{
      font-size: clamp(22px, 3.8vw, 28px);
      font-weight: 900; letter-spacing:.2px;
      margin: 24px 0 8px;
    }
    .sub{ color: var(--muted); margin-bottom: 14px }

    .grid{
      display:grid; grid-template-columns: 1fr; gap:14px;
    }
    @media (min-width:540px){ .grid{ grid-template-columns: repeat(2,1fr) } }
    @media (min-width:920px){ .grid{ grid-template-columns: repeat(3,1fr) } }

    .card{
      background: var(--card);
      border-radius: var(--radius);
      overflow:hidden;
      box-shadow: var(--shadow);
      display:flex; flex-direction:column;
    }
    .thumb{ aspect-ratio: 16/9; width:100%; object-fit:cover; background:#eaf1f3 }
    .card-body{ padding:12px }
    .card h3{ font-size:16px; font-weight:800; margin: 0 0 6px }
    .card p{ color:var(--muted); font-size:13px; margin-bottom:10px }
    .row-btns{ display:flex; gap:8px; }
    .btn{
      flex:1; padding:10px 12px; border-radius:10px; border:0; cursor:pointer; font-weight:800; letter-spacing:.2px;
      background: #e9f6f8; color:#054957;
    }
    .btn:hover{ filter:brightness(.98) }
    .btn.buy{ background: linear-gradient(90deg, var(--brand) 0%, var(--brand-2) 100%); color:#002e36 }

    .msg{ color:#d12f2f; font-size:14px; }

    /* ====== MODAL VIDEO / EBOOK ====== */
    .overlay{
      position:fixed; inset:0; background:rgba(0,0,0,.85);
      display:flex; align-items:center; justify-content:center;
      z-index:1000; padding:18px;
      animation: fade .15s ease;
    }
    .player{
      width:min(960px, 100%); background:#000; border-radius:16px; overflow:hidden; position:relative;
    }
    .player iframe{ width:100%; height:min(70dvh, 520px); border:0; display:block }
    .close{
      position:absolute; top:10px; left:10px;
      background:rgba(0,0,0,.6); border:0; color:#fff; padding:8px 12px; border-radius:999px; cursor:pointer;
    }

    /* FOOTER */
    footer{
      text-align:center; padding:28px 12px; color:#d6f7fc; background: var(--bg);
      font-size:12px; letter-spacing:.2px;
    }

    /* ====== MOBILE NAV ====== */
    @media (max-width: 720px){
      .nav-wrap{ justify-content:space-between; }
      .menu-toggle{ display:flex; }
      .menu{
        position:absolute;
        top:100%;
        right:14px;
        margin-top:8px;
        background:rgba(9, 113, 134, 0.98);
        border-radius:12px;
        padding:6px;
        box-shadow:var(--shadow);
        flex-direction:column;
        align-items:flex-start;
        display:none;
      }
      .menu.open{ display:flex; }
      .menu a, .menu button{
        width:100%;
        text-align:left;
        padding:8px 12px;
      }
    }

    @keyframes fadeUp{
      from{ opacity:0; transform: translateY(8px) }
      to{ opacity:1; transform:none }
    }
    @keyframes fade{ from{ opacity:.6 } to{ opacity:1 } }

    .module-wrapper{
      margin-top:24px;
    }
  </style>
</head>
<body>

<!-- ========= TELA 1 (LANDING) ========= -->
<section id="landing">
  <div class="landing-inner">
    <header class="landing-header">
      <div class="landing-brand">
        <div class="landing-brand-name">PAGINATTO</div>
      </div>
    </header>
    <div class="hero">
      <h1>As melhores receitas e e-books num s√≥ lugar</h1>
      <p>Entre agora na sua √°rea de membros e acesse tudo que j√° est√° liberado para o seu e-mail.</p>
      <button class="btn-primary" id="enterBtn">Acessar</button>
    </div>
  </div>
</section>

<!-- ========= TELA 2 (APP) ========= -->
<header id="appHeader" style="display:none">
  <div class="nav-wrap">
    <div class="brand-mini" id="goHome">
      <img src="LOGO BRANCA COM SOMBRA.png" alt="Paginatto">
      <span>Paginatto</span>
    </div>
    <button class="menu-toggle" id="menuToggle">‚ãÆ</button>
    <nav class="menu" id="menuNav">
      <a href="#" id="menuInicio">In√≠cio</a>
      <a href="#" id="menuVideos">Meus V√≠deos</a>
      <a href="#" id="menuEbooks">Meus E-books</a>
      <a href="#" id="menuRecs">Recomenda√ß√µes</a>
      <button id="logoutBtn">Sair</button>
    </nav>
  </div>
  <div class="search-bar">
    <div class="search">
      <input id="q" placeholder="Buscar receitas, e-books, v√≠deos‚Ä¶ (ex.: dor, bolo, airfryer)">
      <button class="icon-btn" id="btnSearch">üîé</button>
    </div>
  </div>
</header>

<main id="appMain" style="display:none">
  <section class="section" id="videos">
    <h2 class="h2">Suas V√≠deo Aulas</h2>
    <p class="sub">Cursos em v√≠deo liberados para o seu e-mail.</p>
    <div id="gridVideos" class="grid"></div>
    <p id="msgVideos" class="msg" style="display:none"></p>
  </section>

  <section class="section" id="ebooks">
    <h2 class="h2">Seus E-books</h2>
    <p class="sub">E-books liberados para o seu e-mail.</p>
    <div id="gridEbooks" class="grid"></div>
    <p id="msgEbooks" class="msg" style="display:none"></p>
  </section>

  <section class="section" id="modulesSection" style="display:none" data-has-modules="false">
    <h2 class="h2">Conte√∫dos especiais</h2>
    <p class="sub">√Åreas extras liberadas pelos seus combos e cursos especiais.</p>
    <div id="modulesContainer"></div>
  </section>

  <section class="section" id="recs">
    <h2 class="h2">Outros produtos pra voc√™</h2>
    <p class="sub">Sugest√µes do nosso cat√°logo que ainda n√£o est√£o liberadas pra voc√™.</p>
    <div id="gridRecs" class="grid"></div>
    <p id="msgRecs" class="msg" style="display:none"></p>
  </section>
</main>

<footer>¬© 2025 PAGINATTO ‚Äî TODOS OS DIREITOS RESERVADOS.</footer>

<script type="module">
  const el = (id) => document.getElementById(id);

  /* ========= Helpers de Login ========= */
  function getStoredEmail(){
    const email = localStorage.getItem('chef_user_email');
    if (!email) return null;
    return email.toLowerCase().trim();
  }

  function requireLogin(){
    const email = getStoredEmail();
    if (!email){
      window.location.href = 'login.html';
      return null;
    }
    return email;
  }

  /* ===== Helpers Drive / Modal ===== */
  function toDrivePreview(url){
    if (!url) return null;
    try{
      const u = new URL(url);
      if (!u.hostname.includes('drive.google.com')) return url;
      let id = null;
      const m1 = url.match(/\/file\/d\/([^/]+)/);
      if (m1) id = m1[1];
      if (!id && u.searchParams.get('id')) id = u.searchParams.get('id');
      if (!id) return url;
      return `https://drive.google.com/file/d/${id}/preview`;
    }catch(e){
      return url;
    }
  }

  function openPlayer(url, title){
    const wrap = document.createElement('div');
    wrap.className = 'overlay';
    wrap.innerHTML = `
      <div class="player">
        <button class="close" onclick="this.closest('.overlay').remove()">‚Üê Voltar</button>
        <iframe src="${url}" allow="autoplay; encrypted-media" allowfullscreen title="${title||''}"></iframe>
      </div>`;
    document.body.appendChild(wrap);
  }

  function openDriveModal(rawUrl, title){
    const url = toDrivePreview(rawUrl) || rawUrl;
    openPlayer(url, title);
  }

  /* ========= UI B√°sica ========= */
  function showApp(){
    el('landing').style.display   = 'none';
    el('appHeader').style.display = '';
    el('appMain').style.display   = '';
    window.scrollTo({ top:0, behavior:'instant' });
  }

  function showSection(mode){
    const secVideos  = el('videos');
    const secEbooks  = el('ebooks');
    const secRecs    = el('recs');
    const secModules = el('modulesSection');

    if (mode === 'all'){
      secVideos.style.display  = '';
      secEbooks.style.display  = '';
      secRecs.style.display    = '';
      if (secModules.dataset.hasModules === 'true'){
        secModules.style.display = '';
      }else{
        secModules.style.display = 'none';
      }
    } else {
      secVideos.style.display  = mode === 'videos' ? '' : 'none';
      secEbooks.style.display  = mode === 'ebooks' ? '' : 'none';
      secRecs.style.display    = mode === 'recs'   ? '' : 'none';
      secModules.style.display = (mode === 'special' && secModules.dataset.hasModules === 'true') ? '' : 'none';
    }
    window.scrollTo({ top:0, behavior:'smooth' });
  }

  function renderCards(list, container, cta, onOpen){
    container.innerHTML = '';
    if (!Array.isArray(list) || !list.length){
      return;
    }
    list.forEach((p)=>{
      const div = document.createElement('div');
      div.className = 'card';
      const cover = p.cover_image_url || '';
      const desc  = p.description || '';
      div.innerHTML = `
        <img class="thumb" src="${cover}" alt="${p.name||''}">
        <div class="card-body">
          <h3>${p.name||''}</h3>
          <p>${desc}</p>
          <div class="row-btns">
            <button class="btn">${cta}</button>
          </div>
        </div>`;
      div.querySelector('button.btn').addEventListener('click', ()=>onOpen(p));
      container.appendChild(div);
    });
  }

  /* ========= Mapeamento de m√≥dulos por deliverable_key ========= */
  const MODULES_BY_KEY = {
    super_combo_100_videos: './super_combo_100_videos/module.js',
    // se criar outros combos, s√≥ adicionar aqui
    // ex: outro_combo: './outro_combo/module.js',
  };

  /* ========= Loader de M√≥dulos Extras ========= */
  async function loadExtraModules(items, email){
    const section   = el('modulesSection');
    const container = el('modulesContainer');
    if (!section || !container) return;

    container.innerHTML          = '';
    section.style.display        = 'none';
    section.dataset.hasModules   = 'false';

    // pega os deliverable_key √∫nicos
    const keysSet = new Set(
      items
        .map(p => p.deliverable_key ?? p.deliverableKey ?? null)
        .filter(Boolean)
    );
    const keysToLoad = [...keysSet].filter(k => MODULES_BY_KEY[k]);

    if (!keysToLoad.length) return;

    const contextBase = {
      email,
      products: items,      // todos os produtos, pra verifica√ß√£o dentro do m√≥dulo
      openDriveModal,
      toDrivePreview,
    };

    for (const key of keysToLoad){
      const modulePath = MODULES_BY_KEY[key];
      try{
        const mod = await import(modulePath);
        if (!mod || typeof mod.mount !== 'function'){
          console.warn('M√≥dulo sem mount():', key);
          continue;
        }

        const modBox = document.createElement('div');
        modBox.className = 'module-wrapper';
        container.appendChild(modBox);

        await mod.mount(modBox, {
          ...contextBase,
          deliverableKey: key,
        });

        section.dataset.hasModules = 'true';
      }catch(err){
        console.error('Erro ao carregar m√≥dulo', key, err);
      }
    }

    if (section.dataset.hasModules === 'true'){
      section.style.display = '';
    }
  }

  /* ========= /api/my-products ========= */
  async function loadMyProducts(emailParam){
    const email = emailParam || requireLogin();
    if (!email) return;

    try{
      const resp = await fetch('/api/my-products', {
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify({ email })
      });

      const data = await resp.json();
      if (!resp.ok || !data.success){
        throw new Error(data.message || 'Erro ao carregar produtos.');
      }

      const items = Array.isArray(data.products) ? data.products : [];

      // Combos = produtos com deliverable_key mapeado
      const combos = items.filter(
        p => p.deliverable_key && MODULES_BY_KEY[p.deliverable_key]
      );

      // Standalones = o resto (vai pra v√≠deos / ebooks)
      const standalones = items.filter(
        p => !p.deliverable_key || !MODULES_BY_KEY[p.deliverable_key]
      );

      const vids   = standalones.filter(p => (p.type||'').toLowerCase().includes('video'));
      const ebooks = standalones.filter(p => (p.type||'').toLowerCase().includes('ebook'));

      // =========================================
// üî• NOVO SISTEMA: MISTURA VIDEOS + MODULOS
// =========================================

// filtra somente os produtos de v√≠deo "normais"
const videosNormais = standalones.filter(p => 
  (p.type || '').toLowerCase().includes('video')
);

// pega m√≥dulos (combos ou especiais)
const modulosCombo = products.filter(p => 
  p.deliverable_key && p.deliverable_key.trim() !== ''
);

// grid onde vamos mostrar TUDO JUNTO
const grid = el('gridVideos');
grid.innerHTML = '';

// ---- 1) Renderiza v√≠deos normais ----
videosNormais.forEach(p => {
  const card = document.createElement('div');
  card.className = 'card';

  card.innerHTML = `
    <img class="thumb" src="${p.thumbnail || '/img/default.jpg'}">
    <div class="card-body">
      <h3>${p.name}</h3>
      <p style="font-size:14px;color:#0d5f70;">V√≠deo liberado</p>
      <button class="btn">Assistir</button>
    </div>
  `;

  card.querySelector('.btn').onclick = () => {
    const url = p.drive_link || p.checkout_link;
    if (url) openDriveModal(url, p.name);
  };

  grid.appendChild(card);
});

// ---- 2) Renderiza m√≥dulos do combo (JS internos) ----
modulosCombo.forEach(p => {
  const card = document.createElement('div');
  card.className = 'card';

  card.innerHTML = `
    <img class="thumb" src="/img/combo.jpg">
    <div class="card-body">
      <h3>${p.name}</h3>
      <p style="font-size:14px;color:#c8a96a;font-weight:600;">
        Conte√∫do especial do combo
      </p>
      <button class="btn">Acessar m√≥dulo</button>
    </div>
  `;

  card.querySelector('.btn').onclick = () => {
    // abre o m√≥dulo JS correspondente
    openModule(p.deliverable_key);
  };

  grid.appendChild(card);
});

// ---- mensagem quando vazio ----
el('msgVideos').style.display = (videosNormais.length + modulosCombo.length) ? 'none' : '';
el('msgVideos').textContent = (videosNormais.length + modulosCombo.length)
  ? ''
  : 'Voc√™ ainda n√£o tem v√≠deo aulas liberadas.';


      // =========================================
// üî• NOVO SISTEMA: MISTURA EBOOKS + MODULOS
// =========================================

// e-books normais (produtos comuns)
const ebooksNormais = standalones.filter(p =>
  (p.type || '').toLowerCase().includes('ebook')
);

// m√≥dulos (produtos com deliverable_key)
const modulosComboEbooks = products.filter(p =>
  p.deliverable_key && p.deliverable_key.trim() !== ''
);

// grid de e-books (onde tudo ser√° exibido)
const gridE = el('gridEbooks');
gridE.innerHTML = '';

// ---- 1) Renderiza e-books normais ----
ebooksNormais.forEach(p => {
  const card = document.createElement('div');
  card.className = 'card';

  card.innerHTML = `
    <img class="thumb" src="${p.thumbnail || '/img/default.jpg'}">
    <div class="card-body">
      <h3>${p.name}</h3>
      <p style="font-size:14px;color:#0d5f70;">E-book liberado</p>
      <button class="btn">Abrir</button>
    </div>
  `;

  card.querySelector('.btn').onclick = () => {
    const url = p.drive_link || p.checkout_link;
    if (url) openDriveModal(url, p.name);
  };

  gridE.appendChild(card);
});

// ---- 2) Renderiza m√≥dulos do combo como "E-books especiais" ----
modulosComboEbooks.forEach(p => {
  const card = document.createElement('div');
  card.className = 'card';

  card.innerHTML = `
    <img class="thumb" src="/img/combo.jpg">
    <div class="card-body">
      <h3>${p.name}</h3>
      <p style="font-size:14px;color:#c8a96a;font-weight:600;">
        Conte√∫do especial do combo
      </p>
      <button class="btn">Acessar m√≥dulo</button>
    </div>
  `;

  card.querySelector('.btn').onclick = () => {
    openModule(p.deliverable_key);
  };

  gridE.appendChild(card);
});

// ---- mensagem quando vazio ----
el('msgEbooks').style.display = (ebooksNormais.length + modulosComboEbooks.length) ? 'none' : '';
el('msgEbooks').textContent = (ebooksNormais.length + modulosComboEbooks.length)
  ? ''
  : 'Voc√™ ainda n√£o tem e-books liberados.';


      el('msgVideos').style.display = vids.length ? 'none' : '';
      el('msgVideos').textContent   = vids.length ? '' : 'Voc√™ ainda n√£o tem v√≠deo aulas liberadas.';
      el('msgEbooks').style.display = ebooks.length ? 'none' : '';
      el('msgEbooks').textContent   = ebooks.length ? '' : 'Voc√™ ainda n√£o tem e-books liberados.';

      // carrega m√≥dulos (usa lista completa, inclusive combos)
      await loadExtraModules(items, email);

    }catch(e){
      console.error('loadMyProducts error', e);
      el('msgVideos').style.display=''; 
      el('msgVideos').textContent='Erro ao carregar seus v√≠deos.';
      el('msgEbooks').style.display=''; 
      el('msgEbooks').textContent='Erro ao carregar seus e-books.';
    }
  }

  /* ========= /api/recommendations ========= */
  async function loadRecs(emailParam){
    const email = emailParam || requireLogin();
    if (!email) return;

    try{
      const r = await fetch('/api/recommendations?email='+encodeURIComponent(email));
      const data = await r.json();
      if (!r.ok || !data.success){
        throw new Error(data.message || 'Erro ao carregar recomenda√ß√µes.');
      }

      let list = Array.isArray(data.items)
        ? data.items
        : (Array.isArray(data.products) ? data.products : (Array.isArray(data) ? data : []));

      const seen = new Set();
      list = list.filter(p=>{
        const key = p.deliverable_key || p.deliverableKey || p.id;
        if (!key) return true;
        if (seen.has(key)) return false;
        seen.add(key);
        return true;
      });

      const cont = el('gridRecs');
      cont.innerHTML = '';
      list.forEach(p=>{
        const div = document.createElement('div');
        div.className='card';
        div.innerHTML = `
          <img class="thumb" src="${p.cover_image_url||''}" alt="${p.name||''}">
          <div class="card-body">
            <h3>${p.name||''}</h3>
            <p>${p.description||''}</p>
            <div class="row-btns">
              ${p.checkout_link
                ? `<a class="btn buy" href="${p.checkout_link}" target="_blank" rel="noopener">Comprar</a>`
                : `<button class="btn" disabled>Indispon√≠vel</button>`}
            </div>
          </div>`;
        cont.appendChild(div);
      });

      el('msgRecs').style.display = list.length ? 'none' : '';
      el('msgRecs').textContent   = list.length ? '' : 'Nada sugerido no momento.';
    }catch(e){
      console.error('loadRecs error', e);
      el('msgRecs').style.display=''; 
      el('msgRecs').textContent='Falha ao carregar recomenda√ß√µes.';
    }
  }

  /* ========= Eventos de UI ========= */
  el('enterBtn').addEventListener('click', async ()=>{
    const email = requireLogin();
    if (!email) return;

    showApp();
    showSection('all');
    await loadMyProducts(email);
    loadRecs(email);
  });

  el('menuInicio').addEventListener('click', (e)=>{
    e.preventDefault();
    showSection('all');
  });
  el('menuVideos').addEventListener('click', (e)=>{
    e.preventDefault();
    showSection('videos');
  });
  el('menuEbooks').addEventListener('click', (e)=>{
    e.preventDefault();
    showSection('ebooks');
  });
  el('menuRecs').addEventListener('click', (e)=>{
    e.preventDefault();
    showSection('recs');
  });
  el('goHome').addEventListener('click', ()=>{
    showSection('all');
  });

  // menu mobile
  el('menuToggle').addEventListener('click', ()=>{
    el('menuNav').classList.toggle('open');
  });

  // logout
  el('logoutBtn').addEventListener('click', ()=>{
    localStorage.removeItem('chef_user_email');
    location.href = 'login.html';
  });

  // (opcional) gancho da busca ‚Äì ainda sem implementa√ß√£o
  el('btnSearch').addEventListener('click', ()=>{
    // implementar depois se quiser
  });
  el('q').addEventListener('keydown', (e)=>{
    if (e.key === 'Enter'){
      // implementar depois se quiser
    }
  });

  /* ========= Boot autom√°tico se j√° estiver logado ========= */
  (async function boot(){
    const email = getStoredEmail();
    if (!email) return; // fica s√≥ na landing

    showApp();
    showSection('all');
    await loadMyProducts(email);
    loadRecs(email);
  })();
</script>

</body>
</html>




